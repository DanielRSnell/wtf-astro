---
export const prerender = false;

import { getCollection, type CollectionEntry } from 'astro:content';
import Layout from '../../layouts/base.astro';
import { ResourceDirectory } from '@/components/resource-directory.tsx';

// Get all admin resources from the wordpress-resource collection
const adminResources = await getCollection('wordpress-resource', (resource) => {
  return resource.data.category === 'admin';
});

// Get admin-related blog posts
const adminPosts = await getCollection('blog', (post) => {
  return post.data.tags?.some(tag => 
    tag.toLowerCase().includes('admin') || 
    tag.toLowerCase().includes('dashboard') ||
    tag.toLowerCase().includes('wordpress') ||
    adminResources.some(admin => 
      post.data.title.toLowerCase().includes(admin.data.title.toLowerCase()) ||
      post.data.tags?.some(postTag => postTag.toLowerCase().includes(admin.data.title.toLowerCase()))
    )
  );
});

const pageTitle = "Best WordPress Admin Tools (2024) - Reviews & Comparisons | Blocksy Components";
const pageDescription = "Discover the best WordPress admin tools and dashboard customization plugins of 2024. Expert reviews of workflow enhancements, user management tools, and admin interface improvements. Streamline your WordPress site management with professional admin solutions.";

// Create breadcrumb schema
const breadcrumbSchema = {
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "item": {
        "@id": "https://blocksy-components.com",
        "name": "Home"
      }
    },
    {
      "@type": "ListItem",
      "position": 2,
      "item": {
        "@id": "https://blocksy-components.com/wordpress-admin",
        "name": "WordPress Admin Tools"
      }
    }
  ]
};

// Create CollectionPage schema with Product listings
const collectionPageSchema = {
  "@type": "CollectionPage",
  "name": pageTitle,
  "description": pageDescription,
  "url": "https://blocksy-components.com/wordpress-admin",
  "breadcrumb": breadcrumbSchema,
  "mainEntity": {
    "@type": "ItemList",
    "numberOfItems": adminResources.length,
    "itemListElement": adminResources.slice(0, 10).map((resource, index) => ({
      "@type": "Product",
      "position": index + 1,
      "url": `https://blocksy-components.com/wordpress-admin/${resource.slug}`,
      "name": resource.data.title,
      "description": resource.data.description,
      "category": "WordPress Admin Tools",
      "aggregateRating": resource.data.ratings ? {
        "@type": "AggregateRating",
        "ratingValue": Object.values(resource.data.ratings).reduce((a, b) => a + b, 0) / Object.keys(resource.data.ratings).length,
        "bestRating": "5",
        "worstRating": "1",
        "ratingCount": "1"
      } : undefined
    }))
  }
};
---

<Layout 
  title={pageTitle} 
  description={pageDescription}
  image="/open-graph.png"
  schemaType="CollectionPage"
  schemaData={collectionPageSchema}
>
  <ResourceDirectory
    client:load
    data-theme="bright-dark"
    category="admin"
    title="WordPress Admin Tools"
    description="Powerful tools to enhance your WordPress admin experience"
    resources={adminResources}
    relatedPosts={adminPosts}
    baseUrl="/wordpress-admin"
  />
</Layout>